{% extends "base.html" %}

{% block title %}MiniBlog - Inicio{% endblock %}

{% block content %}
<main class="container my-5">

  {% if session.get('user_id') %}
    <h1 class="mb-4">Entradas recientes</h1>

    {% if posts %}
      <div class="list-group">
        {% for post in posts %}
          <a href="{{ url_for('ver_post', post_id=post.id) }}" 
             class="list-group-item list-group-item-action mb-3 shadow-sm rounded">
            <h5 class="mb-1">{{ post.titulo }}</h5>
            <small class="text-muted">
              por {{ post.autor.name }} - {{ post.fecha_create.strftime('%d/%m/%Y %H:%M') }}
            </small>
            <p class="mb-1 mt-2">
              {{ post.contenido[:150] }}{% if post.contenido|length > 150 %}...{% endif %}
            </p>
          </a>
        {% endfor %}
      </div>
    {% else %}
      <p class="mt-3">No hay posteos todavía.</p>
    {% endif %}

  {% else %}
    <h1 class="mb-4">Bienvenido a MiniBlog</h1>
    <p class="lead">MiniBlog es una app donde podés compartir tus ideas.</p>
    <p>Para empezar a publicar y ver el contenido completo, primero registrate o iniciá sesión.</p>
    <p>Mientras tanto, podés navegar y ver las publicaciones públicas que ya están disponibles.</p>

    {% if posts %}
      <div class="list-group mt-4">
        {% for post in posts %}
          <a href="{{ url_for('ver_post', post_id=post.id) }}" 
             class="list-group-item list-group-item-action mb-3 shadow-sm rounded">
            <h5 class="mb-1">{{ post.titulo }}</h5>
            <small class="text-muted">
              por {{ post.autor.name }} - {{ post.fecha_create.strftime('%d/%m/%Y %H:%M') }}
            </small>
            <p class="mb-1 mt-2">
              {{ post.contenido[:150] }}{% if post.contenido|length > 150 %}...{% endif %}
            </p>
          </a>
        {% endfor %}
      </div>
    {% else %}
      <p class="mt-3">No hay posteos todavía.</p>
    {% endif %}
  {% endif %}

</main>
{% endblock %}
